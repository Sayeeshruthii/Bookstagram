{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sayee/Documents/Adv Sw Engg/BookHUB/frontend-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(loginRequestSaga),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(rootsaga);/* eslint-disable import/prefer-default-export */import{put,all,takeEvery}from'redux-saga/effects';import axios from'axios';// import axiosMain from '../../../http/axios/axios_main';\nimport{loginRequestSuccess,showLoader,hideLoader,loginRequestFail}from'../../actions';import*as actionLabels from'../../actionLabels';import{toast}from'react-toastify';// eslint-disable-next-line no-unused-vars\nfunction loginRequestSaga(_ref){var payload,username,password,bodyFormData,axiosMain,config,response;return _regeneratorRuntime.wrap(function loginRequestSaga$(_context){while(1){switch(_context.prev=_context.next){case 0:payload=_ref.payload;_context.prev=1;username=payload.username,password=payload.password;_context.next=5;return put(showLoader());case 5:console.log(\"Response:\",payload);bodyFormData=new FormData();bodyFormData.append('username',username);bodyFormData.append('password',password);axiosMain=axios.create({baseURL:'http://40.80.95.65/store',headers:{}});config={headers:{'content-type':'multipart/form-data'}};_context.next=13;return axiosMain.post('/book/login/',bodyFormData,config);case 13:response=_context.sent;if(!(response.status===200)){_context.next=29;break;}console.log(\"Response:\",response.data);// toast.success(`${response.message}`, {\n//   position: 'top-right',\n//   autoClose: 1000,\n//   hideProgressBar: true,\n//   closeOnClick: true,\n//   pauseOnHover: true,\n//   draggable: true,\n//   progress: undefined,\n// });\n_context.next=18;return localStorage.setItem('userToken',response.data.auth_token.token);case 18:_context.next=20;return localStorage.setItem('userId',JSON.stringify(response.data.app_userid));case 20:_context.next=22;return localStorage.setItem('userData',JSON.stringify(response.data));case 22:_context.next=24;return put(loginRequestSuccess({userToken:response.data.accessToken,userData:response.data.role}));case 24:_context.next=26;return put(hideLoader());case 26:window.location.reload(false);_context.next=34;break;case 29:toast.error(\"\".concat(response.msg),{position:'top-right',autoClose:1000,hideProgressBar:true,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});_context.next=32;return put(loginRequestFail());case 32:_context.next=34;return put(hideLoader());case 34:_context.next=44;break;case 36:_context.prev=36;_context.t0=_context[\"catch\"](1);console.log(\"error\",_context.t0);toast.error(\"Something went wrong\",{position:'top-right',autoClose:1000,hideProgressBar:true,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});_context.next=42;return put(hideLoader());case 42:_context.next=44;return put(loginRequestFail());case 44:case\"end\":return _context.stop();}}},_marked,null,[[1,36]]);}export default function rootsaga(){return _regeneratorRuntime.wrap(function rootsaga$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=all;_context2.next=3;return takeEvery(actionLabels.LOGIN_REQUEST,loginRequestSaga);case 3:_context2.t1=_context2.sent;_context2.t2=[_context2.t1];_context2.next=7;return(0,_context2.t0)(_context2.t2);case 7:case\"end\":return _context2.stop();}}},_marked2);}","map":{"version":3,"sources":["C:/Users/sayee/Documents/Adv Sw Engg/BookHUB/frontend-react/src/store/sagas/auth/auth.js"],"names":["loginRequestSaga","rootsaga","put","all","takeEvery","axios","loginRequestSuccess","showLoader","hideLoader","loginRequestFail","actionLabels","toast","payload","username","password","console","log","bodyFormData","FormData","append","axiosMain","create","baseURL","headers","config","post","response","status","data","localStorage","setItem","auth_token","token","JSON","stringify","app_userid","userToken","accessToken","userData","role","window","location","reload","error","msg","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","LOGIN_REQUEST"],"mappings":"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","sourcesContent":["/* eslint-disable import/prefer-default-export */\r\nimport { put, all, takeEvery } from 'redux-saga/effects';\r\nimport axios from 'axios';\r\n\r\n// import axiosMain from '../../../http/axios/axios_main';\r\nimport { loginRequestSuccess, showLoader, hideLoader, loginRequestFail } from '../../actions';\r\nimport * as actionLabels from '../../actionLabels';\r\nimport { toast } from 'react-toastify';\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nfunction* loginRequestSaga({ payload }) {\r\n  try {\r\n    const { username, password } = payload;\r\n    yield put(showLoader());\r\n    console.log(\"Response:\", payload);\r\n\r\n    var bodyFormData = new FormData();\r\n    bodyFormData.append('username', username);\r\n    bodyFormData.append('password', password);\r\n\r\n    const axiosMain = axios.create({\r\n      baseURL: 'http://40.80.95.65/store',\r\n      headers: {\r\n      },\r\n    });\r\n\r\n    const config = {\r\n      headers: { 'content-type': 'multipart/form-data' }\r\n    }\r\n\r\n\r\n    let response = yield axiosMain.post('/book/login/', bodyFormData, config);\r\n    if (response.status === 200) {\r\n      console.log(\"Response:\", response.data);\r\n      // toast.success(`${response.message}`, {\r\n      //   position: 'top-right',\r\n      //   autoClose: 1000,\r\n      //   hideProgressBar: true,\r\n      //   closeOnClick: true,\r\n      //   pauseOnHover: true,\r\n      //   draggable: true,\r\n      //   progress: undefined,\r\n      // });\r\n      yield localStorage.setItem('userToken', response.data.auth_token.token);\r\n      yield localStorage.setItem('userId', JSON.stringify(response.data.app_userid));\r\n      yield localStorage.setItem('userData', JSON.stringify(response.data));\r\n      yield put(loginRequestSuccess({ userToken: response.data.accessToken, userData: response.data.role }));\r\n      yield put(hideLoader());\r\n      window.location.reload(false);\r\n    } else {\r\n      toast.error(`${response.msg}`, {\r\n        position: 'top-right',\r\n        autoClose: 1000,\r\n        hideProgressBar: true,\r\n        closeOnClick: true,\r\n        pauseOnHover: true,\r\n        draggable: true,\r\n        progress: undefined,\r\n      });\r\n      yield put(loginRequestFail());\r\n      yield put(hideLoader());\r\n    }\r\n  } catch (error) {\r\n    console.log(\"error\", error)\r\n    toast.error(`Something went wrong`, {\r\n      position: 'top-right',\r\n      autoClose: 1000,\r\n      hideProgressBar: true,\r\n      closeOnClick: true,\r\n      pauseOnHover: true,\r\n      draggable: true,\r\n      progress: undefined,\r\n    });\r\n    yield put(hideLoader());\r\n    yield put(loginRequestFail());\r\n  }\r\n}\r\n\r\nexport default function* rootsaga() {\r\n  yield all([\r\n    yield takeEvery(actionLabels.LOGIN_REQUEST, loginRequestSaga),\r\n  ]);\r\n}"]},"metadata":{},"sourceType":"module"}